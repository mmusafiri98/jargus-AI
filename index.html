<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JARVIS AI Assistant</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            background: radial-gradient(circle at center, #03121f, #000000 80%);
            font-family: "Orbitron", sans-serif;
            color: #00eaff;
            height: 100vh;
            overflow: hidden;
        }

        .container-ai {
            height: 100vh;
            display: grid;
            grid-template-columns: 1fr 1.2fr 1fr;
            gap: 20px;
            padding-top: 20px;
        }

        /* Panels */
        .panel {
            border: 2px solid #00eaff;
            border-radius: 15px;
            background: rgba(0, 255, 255, 0.06);
            box-shadow: 0 0 20px #00eaff;
            padding: 15px;
        }

        /* Center Panel */
        #center-panel {
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        #jarvis-gif {
            width: 100%;
            height: 100%;
            object-fit: contain; 
            opacity: 0.9;
        }

        /* Chat */
        #response {
            height: 260px;
            overflow-y: auto;
            color: #b7ffff;
            font-size: 1.1rem;
        }

        #thinking {
            display: none;
            font-size: 1.1rem;
            margin-top: 10px;
            text-align: center;
            animation: blink 1.2s infinite;
        }

        @keyframes blink {
            50% { opacity: 0.3; }
        }

        /* Inputs */
        #user-input {
            background: rgba(0, 80, 100, 0.4);
            border: 1px solid #00eaff;
            color: #b7ffff;
        }

        #submit-btn, #mic-btn {
            background: #00eaff;
            border: none;
            color: #000;
            font-weight: bold;
        }

        #mic-btn {
            background: #003b49;
            color: #00eaff;
            border: 1px solid #00eaff;
        }

        /* Typing effect */
        .typing {
            border-right: 3px solid #00eaff;
            white-space: nowrap;
            overflow: hidden;
            width: 0;
            animation: typing 3s steps(40, end) forwards, blink-cursor 0.75s infinite;
        }

        @keyframes typing {
            from { width: 0; }
            to   { width: 100%; }
        }

        @keyframes blink-cursor {
            50% { border-color: transparent; }
        }
    </style>
</head>

<body>

    <div class="container-ai container">

        <!-- LEFT PANEL -->
        <div class="panel">
            <h3 class="text-center">JARVIS AI</h3>

            <div id="response"></div>
            <div id="thinking">JARVIS Thinking‚Ä¶</div>

            <input id="user-input" type="text" class="form-control mt-3" placeholder="√âcris ton message">

            <div class="d-flex gap-2 mt-3">
                <button id="submit-btn" class="btn w-100">Envoyer</button>
                <button id="mic-btn" class="btn">üé§</button>
            </div>
        </div>

        <!-- CENTER PANEL -->
        <div id="center-panel" class="panel">
            <img id="jarvis-gif" src="jarvis.gif" alt="JARVIS AI">
        </div>

        <!-- RIGHT PANEL -->
        <div class="panel">
            <h3 class="text-center">Syst√®me</h3>
            <p>Fonctions avanc√©es disponibles bient√¥t.</p>
        </div>

    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- ResponsiveVoice -->
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=A0SDeHMK"></script>

    <script>
        const userInput = document.getElementById('user-input');
        const submitBtn = document.getElementById('submit-btn');
        const responseDiv = document.getElementById('response');
        const thinkingDiv = document.getElementById('thinking');
        const micBtn = document.getElementById('mic-btn');

        const systemMessage =
            "Tu es JARVIS AI, un assistant virtuel homme, intelligent et professionnel, cr√©√© par Pepe Musafiri. " +
            "Tu r√©ponds dans la langue de l'utilisateur et tu restes courtois et logique.";

        /* ===================== VOIX ===================== */
        function speak(sentence) {
            responsiveVoice.speak(sentence, "UK English Male", {
                rate: 1,
                pitch: 1
            });
        }

        /* ===================== TYPING EFFECT ===================== */
        function typeWriterEffect(text, element, speed = 25) {
            let i = 0;
            element.innerHTML = "";
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }

        /* ===================== SUBMIT MESSAGE ===================== */
        submitBtn.addEventListener('click', () => sendMessage());
        userInput.addEventListener('keyup', (e) => { if (e.key === "Enter") sendMessage(); });

        /* ===================== MICRO (Speech-to-Text) ===================== */
        micBtn.addEventListener("click", () => {
            const recognition = new webkitSpeechRecognition();
            recognition.lang = "fr-FR";
            recognition.start();
            recognition.onresult = event => {
                userInput.value = event.results[0][0].transcript;
            };
        });

        /* ===================== SEND MESSAGE ===================== */
        async function sendMessage() {
            const text = userInput.value.trim();
            if (!text) return;

            // thinking ON
            thinkingDiv.style.display = "block";

            const aiText = await sendToCosmo(text);

            // thinking OFF
            thinkingDiv.style.display = "none";

            // create new message block
            const p = document.createElement("p");
            p.innerHTML = "<strong>JARVIS:</strong> ";
            const span = document.createElement("span");
            p.appendChild(span);
            responseDiv.appendChild(p);

            // typewriter effect
            typeWriterEffect(aiText, span);

            // scroll down
            responseDiv.scrollTop = responseDiv.scrollHeight;

            // speak
            speak(aiText);

            userInput.value = "";
        }

        /* ===================== API COSMOS ===================== */
        async function sendToCosmo(userText) {
            const apiURL = "https://api.pawan.krd/cosmosrp/v1/chat/completions";

            const payload = {
                model: "cosmosrp",
                messages: [
                    { role: "system", content: systemMessage },
                    { role: "user", content: userText }
                ]
            };

            try {
                const resp = await fetch(apiURL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                const data = await resp.json();
                return data.choices[0].message.content;

            } catch (err) {
                return "Erreur : Impossible de contacter le serveur JARVIS.";
            }
        }
    </script>

</body>
</html>







